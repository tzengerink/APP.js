/*!
 * APP.js
 * ------
 * Copyright (c) 2012, T. Zengerink
 * https://raw.github.com/Mytho/APP.js/master/LISENCE.md
 */
var APP=APP||{};(function(i,c,r){var a,g,p,e,l,m,k,q,s,h,b,o,j,d,n;a={};g={baseUri:"",debug:false,moduleStartMethod:"start",moduleStopMethod:"stop",namespaceDelimiter:"."};p=function(v,u){for(var t in u){v[t]=u[t]}return v};e=(function(){var t={},u=p({},g);t.get=function(v){if(typeof v==="undefined"){return u}else{return u[v]}};t.set=function(v,w){if(typeof v==="object"){u=p(u,v)}u[v]=w;return u};return t})();l=(function(){var t={};t.bind=function(v,w,u){if(v.addEventListener){v.addEventListener(w,u,false)}else{if(v.attachEvent){v.attachEvent("on"+w,u)}}};t.unbind=function(v,w,u){if(v.removeEventListener){v.removeEventListener(w,u,false)}else{if(v.detachEvent){v.detachEvent("on"+w,u)}}};return t})();m=(function(){var t={};t.history=[];t.write=function(){for(var u=arguments.length;u>0;u--){t.history.push(arguments[u-1]);if(e.get("debug")&&c.console){console.log(arguments[u-1])}}};return t})();k=(function(){var w,u,v,t;w={};u=c.location.host;v=c.location.protocol;t=function(x){return x.replace(/^\/|\/$/g,"")};w.base=function(){return[v,"//",u,(t(e.get("baseUri"))?"/":""),t(e.get("baseUri"))].join("")};w.site=function(x){return[w.base(),"/",t(x)].join("")};return w})();q=function(t){return t.split(e.get("namespaceDelimiter")).pop()};s=function(t){return o(t.split(e.get("namespaceDelimiter")).slice(0,-1).join(e.get("namespaceDelimiter")))};h=function(u,x){var t,w,v;v=x!==false?e.get("moduleStartMethod"):e.get("moduleStopMethod");t=function(y){return typeof u[y]==="object"&&y.charAt(0)===y.charAt(0).toUpperCase()};for(w in u){if(t(w)){if(w!=="Core"&&u[w].hasOwnProperty(v)){u[w][v].call()}h(u[w],x)}}};b=function(x,y,w){if(typeof w==="undefined"){w=y;y=[]}var t=q(x),v=s(x),u=(typeof w==="function")?w.apply(this,y):w;switch(typeof u){case"object":v[t]=p((v[t]||{}),u);break;default:v[t]=u;break}};o=function(v){var t=0,u=v.split(e.get("namespaceDelimiter")),w=this;for(;t<u.length;t++){w[u[t]]=w[u[t]]||{};w=w[u[t]]}return w};j=(function(){var u,t,x,v,y,w;v=[];y=r.documentElement;w=false;t=function(){w=true;while(f=v.shift()){f()}};if(y.doScroll){u=function(){try{y.doScroll("left");t()}catch(z){setTimeout(u,10)}};u()}l.bind(r,"DOMContentLoaded",x=function(){l.unbind(r,"DOMContentLoaded",x);t()});return function(z){w?z():v.push(z)}})();d=function(t){e.set(t);j(function(){h(i)})};n=function(){h(i,false)};a.extend=p;a.Config=e;a.Events=l;a.Log=m;a.Url=k;i.module=b;i.ready=j;i.start=d;i.stop=n;i.Core=a;c.log=a.Log.write})(APP,window,document);APP.module("APP.PubSub",function(){var a={},b={};a.off=function(c){if(typeof c!=="string"){throw new Error("Topic must be a string")}b[c]=[]};a.on=function(c,d){if(typeof c!=="string"){throw new Error("Topic must be a string")}if(typeof d!=="function"){throw new Error("Callback must be a function")}if(typeof b[c]==="undefined"){b[c]=[]}b[c].push(d)};a.trigger=function(d,c){if(typeof d!=="string"){throw new Error("Topic must be a string")}for(var e in b[d]){b[d][e](c)}};return a});APP.module("APP.KeyHandler",[document,APP.PubSub,APP.Core.Events],function(h,b,a){var c,d,g,e;c={};g="KeyHandler-";d={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9"};e=function(i){if(/input|textarea|select/i.test((i.target||i.srcElement).nodeName)){return}b.trigger([g,d[i.keyCode]].join(""),i)};c.off=function(i){return b.off([g,i.toLowerCase()].join(""))};c.on=function(i,j){return b.on([g,i.toLowerCase()].join(""),j)};c.trigger=function(j,i){return b.trigger([g,j.toLowerCase()].join(""),i)};a.bind(h,"keyup",e);return c});