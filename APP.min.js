/*!
 * APP.js
 * ------
 * Copyright (c) 2012, T. Zengerink
 * https://raw.github.com/Mytho/APP.js/master/LISENCE.md
 */
var APP=APP||{};(function(m,e){var g={},l={baseUri:"",debug:false,moduleStartMethod:"start",moduleStopMethod:"stop",namespaceDelimiter:"."};var i=function(q,p){for(var o in p){q[o]=p[o]}return q};var c=function(o){if(typeof o==="string"){return l[o]}else{if(typeof o==="object"){return i(l,o)}}return l};var h=function(o){return o.split(l.namespaceDelimiter).pop()};var j=function(p){var o=p.split(l.namespaceDelimiter);o.pop();return d(o.join(l.namespaceDelimiter))};var n=function(o,r){var q=r!==false?l.moduleStartMethod:l.moduleStopMethod;for(var p in o){if(typeof o[p]==="object"&&p.charAt(0)===p.charAt(0).toUpperCase()){if(p!=="Core"&&o[p].hasOwnProperty(q)){o[p][q].call()}n(o[p],r)}}};var d=function(r){var p=0,q=r.split(l.namespaceDelimiter),t=this;for(;p<q.length;p++){t[q[p]]=t[q[p]]||{};t=t[q[p]]}return t};var b=(function(){return function(s,t,r){if(typeof r==="undefined"){r=t;t=[]}var o=h(s),q=j(s),p=(typeof r==="function")?r.apply(this,t):r;switch(typeof p){case"object":q[o]=i((q[o]||{}),p);break;default:q[o]=p;break}}})();var a=function(o){c(o);n(m)};var k=function(){n(m,false)};g.Url=(function(){var o={},p=e.location.host,q=e.location.protocol;o.base=function(){return q+"//"+p+(l.baseUri.replace(/^\/|\/$/g,"")&&"/"+l.baseUri.replace(/^\/|\/$/g,""))};o.site=function(r){return o.base()+"/"+r.replace(/^\/|\/$/g,"")};return o})();g.Log=(function(){var o={};o.history=[];o.write=function(){for(var p=arguments.length;p>0;p--){o.history.push(arguments[p-1]);if(l.debug&&e.console){console.log(arguments[p-1])}}};return o})();g.config=c;g.extend=i;m.module=b;m.start=a;m.stop=k;m.Core=g;e.log=g.Log.write})(APP,window);APP.module("APP.ready",[document],function(h){var b=[],d,c=false;var a=function(){c=true;while(f=b.shift()){f()}};var g=function(j,k,i){if(j.removeEventListener){j.removeEventListener(k,i,false)}else{if(j.detachEvent){j.detachEvent("on"+k,i)}}};var e=function(j,k,i){if(j.addEventListener){j.addEventListener(k,i,false)}else{if(j.attachEvent){j.attachEvent("on"+k,i)}}};e(h,"DOMContentLoaded",d=function(){g(h,"DOMContentLoaded",d);a()});return function(i){c?i():b.push(i)}});APP.module("APP.PubSub",function(){var a={},b={};a.off=function(c){if(typeof c!=="string"){throw new Error("Topic must be a string")}b[c]=[]};a.on=function(c,d){if(typeof c!=="string"){throw new Error("Topic must be a string")}if(typeof d!=="function"){throw new Error("Callback must be a function")}if(typeof b[c]==="undefined"){b[c]=[]}b[c].push(d)};a.trigger=function(d,c){if(typeof d!=="string"){throw new Error("Topic must be a string")}for(var e in b[d]){b[d][e](c)}};return a});APP.module("APP.KeyHandler",[document,APP.PubSub],function(h,a){var b={},g="KeyHandler-",d={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9"};var c=function(j,k,i){if(j.addEventListener){j.addEventListener(k,i,false)}else{if(j.attachEvent){j.attachEvent("on"+k,i)}}};var e=function(i){if(/input|textarea|select/i.test((i.target||i.srcElement).nodeName)){return}a.trigger([g,d[i.keyCode]].join(""),i)};b.off=function(i){return a.off([g,i.toLowerCase()].join(""))};b.on=function(i,j){return a.on([g,i.toLowerCase()].join(""),j)};b.trigger=function(j,i){return a.trigger([g,j.toLowerCase()].join(""),i)};c(h,"keyup",e);return b});