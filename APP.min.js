/*!
 * APP.js
 * ------
 * Copyright (c) 2012, T. Zengerink
 * https://raw.github.com/Mytho/APP.js/master/LISENCE.md
 */
var APP=APP||{};(function(h,c,q){var a,f,o,e,k,l,j,p,r,g,b,n,i,d,m;a={};f={baseUri:"",debug:false,moduleStartMethod:"start",moduleStopMethod:"stop",namespaceDelimiter:"."};o=function(u,t){var s;for(s in t){if(t.hasOwnProperty(s)){u[s]=t[s]}}return u};e=(function(){var s={},t=o({},f);s.get=function(u){if(u===undefined){return t}return t[u]};s.set=function(u,v){if(typeof u==="object"){t=o(t,u)}t[u]=v;return t};return s})();k=(function(){var s={};s.bind=function(u,v,t){if(u.addEventListener){u.addEventListener(v,t,false)}else{if(u.attachEvent){u.attachEvent("on"+v,t)}}};s.unbind=function(u,v,t){if(u.removeEventListener){u.removeEventListener(v,t,false)}else{if(u.detachEvent){u.detachEvent("on"+v,t)}}};return s})();l=(function(){var s,t;s={};s.history=[];s.write=function(){for(t=arguments.length;t>0;t--){s.history.push(arguments[t-1]);if(e.get("debug")&&c.console){c.console.log(arguments[t-1])}}};return s})();j=(function(){var v,t,u,s;v={};t=c.location.host;u=c.location.protocol;s=function(w){return w.replace(/^\/|\/$/g,"")};v.base=function(){return[u,"//",t,(s(e.get("baseUri"))?"/":""),s(e.get("baseUri"))].join("")};v.site=function(w){return[v.base(),"/",s(w)].join("")};return v})();p=function(s){return s.split(e.get("namespaceDelimiter")).pop()};r=function(s){return n(s.split(e.get("namespaceDelimiter")).slice(0,-1).join(e.get("namespaceDelimiter")))};g=function(t,w){var s,v,u;u=w!==false?e.get("moduleStartMethod"):e.get("moduleStopMethod");s=function(x){return typeof t[x]==="object"&&x.charAt(0)===x.charAt(0).toUpperCase()};for(v in t){if(t.hasOwnProperty(v)&&s(v)){if(v!=="Core"&&t[v].hasOwnProperty(u)){t[v][u].call()}g(t[v],w)}}};b=function(w,x,v){if(v===undefined){v=x;x=[]}var s=p(w),u=r(w),t=(typeof v==="function")?v.apply(this,x):v;u[s]=t;if(typeof t==="object"){u[s]=o((u[s]||{}),t)}};n=function(v){var t=0,u=v.split(e.get("namespaceDelimiter")),w=c;for(t;t<u.length;t++){w[u[t]]=w[u[t]]||{};w=w[u[t]]}return w};i=(function(){var t,y,s,x,v,u,w;v=[];y=q.documentElement;w=false;s=function(){w=true;for(u=v.length;u>0;u--){v[u]()}};if(y.doScroll){t=function(){try{y.doScroll("left");s()}catch(z){c.setTimeout(t,10)}};t()}k.bind(q,"DOMContentLoaded",x=function(){k.unbind(q,"DOMContentLoaded",x);s()});return function(z){if(w){z()}else{v.push(z)}}})();d=function(s){e.set(s);i(function(){g(h)})};m=function(){g(h,false)};a.extend=o;a.Config=e;a.Events=k;a.Log=l;a.Url=j;h.module=b;h.ready=i;h.start=d;h.stop=m;h.Core=a;c.log=a.Log.write})(APP,window,document);APP.module("APP.PubSub",function(){var a={},b={};a.off=function(c){if(typeof c!=="string"){throw new Error("Topic must be a string")}b[c]=[]};a.on=function(c,d){if(typeof c!=="string"){throw new Error("Topic must be a string")}if(typeof d!=="function"){throw new Error("Callback must be a function")}if(typeof b[c]==="undefined"){b[c]=[]}b[c].push(d)};a.trigger=function(d,c){var e;if(typeof d!=="string"){throw new Error("Topic must be a string")}for(e in b[d]){if(b[d].hasOwnProperty(e)){b[d][e](c)}}};return a});APP.module("APP.KeyHandler",[document,APP.PubSub,APP.Core.Events],function(g,b,a){var c,d,f,e;c={};f="KeyHandler-";d={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9"};e=function(h){if(/input|textarea|select/i.test((h.target||h.srcElement).nodeName)){return}b.trigger([f,d[h.keyCode]].join(""),h)};c.off=function(h){return b.off([f,h.toLowerCase()].join(""))};c.on=function(h,i){return b.on([f,h.toLowerCase()].join(""),i)};c.trigger=function(i,h){return b.trigger([f,i.toLowerCase()].join(""),h)};a.bind(g,"keyup",e);return c});