/*!
 * APP.js
 * ------
 * Copyright (c) 2012, T. Zengerink
 * https://raw.github.com/Mytho/APP.js/master/LISENCE.md
 */
var APP=APP||{};(function(o,g,n){var c,i,q,d,k,h,j,p,b,e,m,a,l;i={};d={baseUri:"",debug:false,moduleStartMethod:"start",moduleStopMethod:"stop",namespaceDelimiter:"."};k=function(t,s){for(var r in s){t[r]=s[r]}return t};c=(function(){var r,s;r={};s=k({},d);r.get=function(t){if(typeof t==="undefined"){return s}else{return s[t]}};r.set=function(t,u){if(typeof t==="object"){s=k(s,t)}s[t]=u;return s};return r})();q=(function(){var r={};r.bind=function(t,u,s){if(t.addEventListener){t.addEventListener(u,s,false)}else{if(t.attachEvent){t.attachEvent("on"+u,s)}}};r.unbind=function(t,u,s){if(t.removeEventListener){t.removeEventListener(u,s,false)}else{if(t.detachEvent){t.detachEvent("on"+u,s)}}};return r})();h=function(r){return r.split(c.get("namespaceDelimiter")).pop()};j=function(s){var r=s.split(c.get("namespaceDelimiter"));r.pop();return e(r.join(c.get("namespaceDelimiter")))};p=function(r,u){var t=u!==false?c.get("moduleStartMethod"):c.get("moduleStopMethod");for(var s in r){if(typeof r[s]==="object"&&s.charAt(0)===s.charAt(0).toUpperCase()){if(s!=="Core"&&r[s].hasOwnProperty(t)){r[s][t].call()}p(r[s],u)}}};b=(function(){return function(v,w,u){var s,r,t;if(typeof u==="undefined"){u=w;w=[]}r=h(v);t=j(v);s=(typeof u==="function")?u.apply(this,w):u;switch(typeof s){case"object":t[r]=k((t[r]||{}),s);break;default:t[r]=s;break}}})();e=function(u){var r,t,v;r=0;t=u.split(c.get("namespaceDelimiter"));v=this;for(;r<t.length;r++){v[t[r]]=v[t[r]]||{};v=v[t[r]]}return v};m=(function(){var s,w,r,v,t,u;t=[];w=n.documentElement;u=false;r=function(){u=true;while(f=t.shift()){f()}};if(w.doScroll){var s=function(){try{w.doScroll("left");r()}catch(x){setTimeout(s,10)}};s()}q.bind(n,"DOMContentLoaded",v=function(){q.unbind(n,"DOMContentLoaded",v);r()});return function(x){u?x():t.push(x)}})();a=function(r){c.set(r);m(function(){p(o)})};l=function(){p(o,false)};i.Log=(function(){var r={};r.history=[];r.write=function(){for(var s=arguments.length;s>0;s--){r.history.push(arguments[s-1]);if(c.get("debug")&&g.console){console.log(arguments[s-1])}}};return r})();i.Url=(function(){var r,s,t;r=g.location.host;s=g.location.protocol;t={};t.base=function(){return s+"//"+r+(c.get("baseUri").replace(/^\/|\/$/g,"")&&"/"+c.get("baseUri").replace(/^\/|\/$/g,""))};t.site=function(u){return t.base()+"/"+u.replace(/^\/|\/$/g,"")};return t})();i.extend=k;i.Config=c;i.Events=q;o.module=b;o.ready=m;o.start=a;o.stop=l;o.Core=i;g.log=i.Log.write})(APP,window,document);APP.module("APP.PubSub",function(){var a,b;a={};b={};a.off=function(c){if(typeof c!=="string"){throw new Error("Topic must be a string")}b[c]=[]};a.on=function(c,d){if(typeof c!=="string"){throw new Error("Topic must be a string")}if(typeof d!=="function"){throw new Error("Callback must be a function")}if(typeof b[c]==="undefined"){b[c]=[]}b[c].push(d)};a.trigger=function(d,c){if(typeof d!=="string"){throw new Error("Topic must be a string")}for(var e in b[d]){b[d][e](c)}};return a});APP.module("APP.KeyHandler",[document,APP.PubSub,APP.Core.Events],function(h,b,a){var c,d,g,e;c={};g="KeyHandler-";d={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9"};e=function(i){if(/input|textarea|select/i.test((i.target||i.srcElement).nodeName)){return}b.trigger([g,d[i.keyCode]].join(""),i)};c.off=function(i){return b.off([g,i.toLowerCase()].join(""))};c.on=function(i,j){return b.on([g,i.toLowerCase()].join(""),j)};c.trigger=function(j,i){return b.trigger([g,j.toLowerCase()].join(""),i)};a.bind(h,"keyup",e);return c});