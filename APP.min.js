/*!
 * APP.js
 * ------
 * Copyright (c) 2012, T. Zengerink
 * https://raw.github.com/Mytho/APP.js/master/LISENCE.md
 */
var APP=APP||{};(function(n,e,l){var g={},m={baseUri:"",debug:false,moduleStartMethod:"start",moduleStopMethod:"stop",namespaceDelimiter:"."};var j=function(r,q){for(var p in q){r[p]=q[p]}return r};var c=function(p){if(typeof p==="string"){return m[p]}else{if(typeof p==="object"){return j(m,p)}}return m};var h=function(p){return p.split(m.namespaceDelimiter).pop()};var i=function(q){var p=q.split(m.namespaceDelimiter);p.pop();return d(p.join(m.namespaceDelimiter))};var o=function(p,s){var r=s!==false?m.moduleStartMethod:m.moduleStopMethod;for(var q in p){if(typeof p[q]==="object"&&q.charAt(0)===q.charAt(0).toUpperCase()){if(q!=="Core"&&p[q].hasOwnProperty(r)){p[q][r].call()}o(p[q],s)}}};var d=function(r){var p=0,q=r.split(m.namespaceDelimiter),t=this;for(;p<q.length;p++){t[q[p]]=t[q[p]]||{};t=t[q[p]]}return t};var b=(function(){return function(t,u,s){if(typeof s==="undefined"){s=u;u=[]}var p=h(t),r=i(t),q=(typeof s==="function")?s.apply(this,u):s;switch(typeof q){case"object":r[p]=j((r[p]||{}),q);break;default:r[p]=q;break}}})();var a=function(p){c(p);o(n)};var k=function(){o(n,false)};g.Events=(function(){var p={};p.addListener=function(r,s,q){if(r.addEventListener){r.addEventListener(s,q,false)}else{if(r.attachEvent){r.attachEvent("on"+s,q)}}};p.removeListener=function(r,s,q){if(r.removeEventListener){r.removeEventListener(s,q,false)}else{if(r.detachEvent){r.detachEvent("on"+s,q)}}};return p})();g.Log=(function(){var p={};p.history=[];p.write=function(){for(var q=arguments.length;q>0;q--){p.history.push(arguments[q-1]);if(m.debug&&e.console){console.log(arguments[q-1])}}};return p})();g.Url=(function(){var r={},p=e.location.host,q=e.location.protocol;r.base=function(){return q+"//"+p+(m.baseUri.replace(/^\/|\/$/g,"")&&"/"+m.baseUri.replace(/^\/|\/$/g,""))};r.site=function(s){return r.base()+"/"+s.replace(/^\/|\/$/g,"")};return r})();g.config=c;g.extend=j;n.ready=(function(){var r=[],t,u=l.documentElement,s=false;var p=function(){s=true;while(f=r.shift()){f()}};if(u.doScroll){var q=function(){try{u.doScroll("left");p()}catch(v){setTimeout(q,10)}};q()}g.Events.addListener(l,"DOMContentLoaded",t=function(){g.Events.removeListener(l,"DOMContentLoaded",t);p()});return function(v){s?v():r.push(v)}})();n.module=b;n.start=a;n.stop=k;n.Core=g;e.log=g.Log.write})(APP,window,document);APP.module("APP.PubSub",function(){var a={},b={};a.off=function(c){if(typeof c!=="string"){throw new Error("Topic must be a string")}b[c]=[]};a.on=function(c,d){if(typeof c!=="string"){throw new Error("Topic must be a string")}if(typeof d!=="function"){throw new Error("Callback must be a function")}if(typeof b[c]==="undefined"){b[c]=[]}b[c].push(d)};a.trigger=function(d,c){if(typeof d!=="string"){throw new Error("Topic must be a string")}for(var e in b[d]){b[d][e](c)}};return a});APP.module("APP.KeyHandler",[document,APP.PubSub,APP.Core.Events],function(h,b,a){var c={},g="KeyHandler-",d={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9"};var e=function(i){if(/input|textarea|select/i.test((i.target||i.srcElement).nodeName)){return}b.trigger([g,d[i.keyCode]].join(""),i)};c.off=function(i){return b.off([g,i.toLowerCase()].join(""))};c.on=function(i,j){return b.on([g,i.toLowerCase()].join(""),j)};c.trigger=function(j,i){return b.trigger([g,j.toLowerCase()].join(""),i)};a.addListener(h,"keyup",e);return c});