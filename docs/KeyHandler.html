<!DOCTYPE html>  <html> <head>   <title>KeyHandler.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="Core.html">                 Core.coffee               </a>                                           <a class="source" href="KeyHandler.html">                 KeyHandler.coffee               </a>                                           <a class="source" href="PubSub.html">                 PubSub.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               KeyHandler.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>KeyHandler is a lightweight JavaScript module, with <strong>mimimum</strong> key binding
functionality. A function can be bound to a key like this:</p>

<pre><code>APP.KeyHandler.bind 'R', -&gt;
    window.location.reload() # Reload the window for example
</code></pre>

<p>To trigger a keyup event:</p>

<pre><code>APP.KeyHandler.trigger 'R'
</code></pre>

<p>And to unbind:</p>

<pre><code>APP.KeyHandler.unbind 'R'
</code></pre>

<p>Copyright 2012, T. Zengerink <br />
See: <a href="https://raw.github.com/Mytho/APP.js/master/LISENCE.md">MIT License</a></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">APP</span><span class="p">.</span><span class="nx">module</span> <span class="s">&#39;APP.KeyHandler&#39;</span><span class="p">,</span> <span class="p">[</span>
  <span class="nb">document</span>
  <span class="nx">APP</span><span class="p">.</span><span class="nx">PubSub</span>
  <span class="nx">APP</span><span class="p">.</span><span class="nx">Events</span>
<span class="p">],</span> <span class="nf">(doc, PubSub, Events) -&gt;</span>
  <span class="s">&#39;use strict&#39;</span>

  <span class="nv">prefix = </span><span class="s">&#39;KeyHandler-&#39;</span>

  <span class="nv">keys =</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Special keys</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="mi">8</span><span class="o">:</span><span class="s">&#39;backspace&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="o">:</span><span class="s">&#39;tab&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="o">:</span><span class="s">&#39;enter&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="o">:</span><span class="s">&#39;shift&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="o">:</span><span class="s">&#39;ctrl&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="o">:</span><span class="s">&#39;alt&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Arrow keys</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="mi">37</span><span class="o">:</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="o">:</span><span class="s">&#39;up&#39;</span><span class="p">,</span> <span class="mi">39</span><span class="o">:</span><span class="s">&#39;right&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="o">:</span><span class="s">&#39;down&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Numbers</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="mi">48</span><span class="o">:</span><span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="mi">49</span><span class="o">:</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="o">:</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="o">:</span><span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="o">:</span><span class="s">&#39;4&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="o">:</span><span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="o">:</span><span class="s">&#39;6&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="o">:</span><span class="s">&#39;7&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="o">:</span><span class="s">&#39;8&#39;</span><span class="p">,</span>
      <span class="mi">57</span><span class="o">:</span><span class="s">&#39;9&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Alpha</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="mi">65</span><span class="o">:</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">66</span><span class="o">:</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">67</span><span class="o">:</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">68</span><span class="o">:</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">69</span><span class="o">:</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="o">:</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="o">:</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="o">:</span><span class="s">&#39;h&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="o">:</span><span class="s">&#39;i&#39;</span><span class="p">,</span>
      <span class="mi">74</span><span class="o">:</span><span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="o">:</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="mi">76</span><span class="o">:</span><span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="mi">77</span><span class="o">:</span><span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="mi">78</span><span class="o">:</span><span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="mi">79</span><span class="o">:</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="o">:</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="o">:</span><span class="s">&#39;q&#39;</span><span class="p">,</span> <span class="mi">82</span><span class="o">:</span><span class="s">&#39;r&#39;</span><span class="p">,</span>
      <span class="mi">83</span><span class="o">:</span><span class="s">&#39;s&#39;</span><span class="p">,</span> <span class="mi">84</span><span class="o">:</span><span class="s">&#39;t&#39;</span><span class="p">,</span> <span class="mi">85</span><span class="o">:</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="mi">86</span><span class="o">:</span><span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="mi">87</span><span class="o">:</span><span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="mi">88</span><span class="o">:</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="mi">89</span><span class="o">:</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="mi">90</span><span class="o">:</span><span class="s">&#39;z&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Function keys</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="mi">112</span><span class="o">:</span><span class="s">&#39;f1&#39;</span><span class="p">,</span> <span class="mi">113</span><span class="o">:</span><span class="s">&#39;f2&#39;</span><span class="p">,</span> <span class="mi">114</span><span class="o">:</span><span class="s">&#39;f3&#39;</span><span class="p">,</span> <span class="mi">115</span><span class="o">:</span><span class="s">&#39;f4&#39;</span><span class="p">,</span> <span class="mi">116</span><span class="o">:</span><span class="s">&#39;f5&#39;</span><span class="p">,</span> <span class="mi">117</span><span class="o">:</span><span class="s">&#39;f6&#39;</span><span class="p">,</span> <span class="mi">118</span><span class="o">:</span><span class="s">&#39;f7&#39;</span><span class="p">,</span>
      <span class="mi">119</span><span class="o">:</span><span class="s">&#39;f8&#39;</span><span class="p">,</span> <span class="mi">120</span><span class="o">:</span><span class="s">&#39;f9&#39;</span><span class="p">,</span> <span class="mi">121</span><span class="o">:</span><span class="s">&#39;f10&#39;</span><span class="p">,</span> <span class="mi">122</span><span class="o">:</span><span class="s">&#39;f11&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="o">:</span><span class="s">&#39;f12&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Numpad</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="mi">96</span><span class="o">:</span><span class="s">&#39;num0&#39;</span><span class="p">,</span> <span class="mi">97</span><span class="o">:</span><span class="s">&#39;num1&#39;</span><span class="p">,</span> <span class="mi">98</span><span class="o">:</span><span class="s">&#39;num2&#39;</span><span class="p">,</span> <span class="mi">99</span><span class="o">:</span><span class="s">&#39;num3&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">:</span><span class="s">&#39;num4&#39;</span><span class="p">,</span> <span class="mi">101</span><span class="o">:</span><span class="s">&#39;num5&#39;</span><span class="p">,</span>
      <span class="mi">102</span><span class="o">:</span><span class="s">&#39;num6&#39;</span><span class="p">,</span> <span class="mi">103</span><span class="o">:</span><span class="s">&#39;num7&#39;</span><span class="p">,</span> <span class="mi">104</span><span class="o">:</span><span class="s">&#39;num8&#39;</span><span class="p">,</span> <span class="mi">105</span><span class="o">:</span><span class="s">&#39;num9&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Only handle event (<code>e</code>) if focus not on input, textarea or select.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">handle = </span><span class="nf">(e) -&gt;</span> 
    <span class="k">if</span> <span class="o">not</span> <span class="sr">/input|textarea|select/i</span><span class="p">.</span><span class="nx">test</span><span class="p">((</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span> <span class="o">or</span> <span class="nx">e</span><span class="p">.</span><span class="nx">srcElement</span><span class="p">).</span><span class="nx">nodeName</span><span class="p">)</span> 
      <span class="nx">PubSub</span><span class="p">.</span><span class="nx">trigger</span><span class="p">([</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">]].</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span> <span class="nx">e</span><span class="p">)</span>

  <span class="nx">Events</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="s">&#39;keyup&#39;</span><span class="p">,</span> <span class="nx">handle</span><span class="p">)</span>

  <span class="kc">off</span><span class="o">:</span> <span class="nf">(key) -&gt;</span> <span class="nx">PubSub</span><span class="p">.</span><span class="kc">off</span><span class="p">([</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">key</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()].</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">))</span>
  <span class="kc">on</span><span class="o">:</span> <span class="nf">(key, fn) -&gt;</span> <span class="nx">PubSub</span><span class="p">.</span><span class="kc">on</span><span class="p">([</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">key</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()].</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span> <span class="nx">fn</span><span class="p">)</span>
  <span class="nv">trigger: </span><span class="nf">(key, args) -&gt;</span> <span class="nx">PubSub</span><span class="p">.</span><span class="nx">trigger</span><span class="p">([</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">key</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()].</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span> <span class="nx">args</span><span class="p">)</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 