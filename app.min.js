/*!
 * APP.js
 * Author: T. Zengerink (t.zengerink@gmail.com)
 * Copyright (c) 2012-2013 T. Zengerink
 * MIT lisenced, https://raw.github.com/Mytho/APP.js/master/LISENCE.md
 */
window.APP=function(e,t){"use strict";var n,r,i,s,o,u,a,f,l,c,h,p,d;return a={baseUri:"",debug:!0},u=function(){return Array.prototype.slice.call(arguments).join("")},f=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n=function(){var e;return e=f({},a),{get:function(t){return t?e[t]:e},set:function(t,n){return typeof t=="object"&&(e=f(e,t)),e[t]=n,e}}}(),r=function(){var e;return e={},{bind:function(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent)return e.attachEvent("on"+t,n)},unbind:function(e,t,n){if(e.removeEventListener)return e.removeEventListener(t,n,!1);if(e.detachEvent)return e.detachEvent("on"+t,n)},off:function(t){if(typeof t!="string")throw new Error("Topic must be a string");return e[t]=[]},on:function(t,n){if(typeof t!="string")throw new Error("Topic must be a string");if(typeof n!="function")throw new Error("Callback must be a function");return typeof e[t]=="undefined"&&(e[t]=[]),e[t].push(n)},trigger:function(t,n){var r,i;if(typeof t!="string")throw new Error("Topic must be a string");i=[];for(r in e[t])e[t].hasOwnProperty(r)?i.push(e[t][r](n)):i.push(void 0);return i}}}(),i=function(){var e,n,i;return i="KeyHandler-",n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9"},e=function(e){if(!/input|textarea|select/i.test((e.target||e.srcElement).nodeName))return r.trigger(u(i,n[e.keyCode]),e)},r.bind(t,"keyup",e),{off:function(e){return r.off(u(i,e.toLowerCase()))},on:function(e,t){return r.on(u(i,e.toLowerCase()),t)},trigger:function(e,t){return r.trigger(u(i,e.toLowerCase()),t)}}}(),s=function(){return{history:[],write:function(){var t,r,i;for(r=0,i=arguments.length;r<i;r++)t=arguments[r],s.history.push(t);if(n.get("debug")&&e.console)return e.console.log(arguments)}}}(),o=function(){var t;return t=function(e){return e.replace(/^\/|\/$/g,"")},{base:function(){var r;return t(n.get("baseUri"))&&(r="/"),u(e.location.protocol,"//",e.location.host,r,t(n.get("baseUri")))},site:function(e){return u(o.base(),"/",t(e))}}}(),c=function(){var t,n,r;return t=function(e){return e.split(".").pop()},n=function(e){var t;return t=e.split(".").slice(0,-1),r(t.join("."))},r=function(t){var n,r,i,s,o;r=e,o=t.split(".");for(i=0,s=o.length;i<s;i++)n=o[i],r[n]=r[n]||{},r=r[n];return r},function(e,r,i){var s,o;typeof i=="undefined"&&(i=r,r=[]),o=n(e),s=t(e),c=i,typeof c=="function"&&(c=i.apply(this,r)),o[s]=c;if(typeof c=="object")return o[s]=f(o[s]||{},c)}}(),h=function(){var n,i,s,o,u,a;return i=!1,u=[],a=!1,s=function(){var e,t,n,r;clearTimeout(a),i=!0,r=[];for(t=0,n=u.length;t<n;t++)e=u[t],r.push(e.call());return r},t.documentElement&&(n=function(){try{t.documentElement.doScroll("left"),s()}catch(r){a=e.setTimeout(n,20)}return!1},n()),r.bind(t,"DOMContentLoaded",o=function(){return r.unbind(t,"DOMContentLoaded",o),s()}),function(e){return i?e():u.push(e)}}(),l=function(e,t){var n,r,i,s;r=t===!1?"stop":"start",n=function(t){var n,r;return n=typeof e[t]=="object",r=t.charAt(0)===t.charAt(0).toUpperCase(),n&&r},s=[];for(i in e)e.hasOwnProperty(i)&&n(i)?(e[i].hasOwnProperty(r)&&e[i][r].call(),s.push(l(e[i],t))):s.push(void 0);return s},p=function(e){return n.set(e),h(function(){return l(APP)})},d=function(){return l(APP,!1)},{Config:n,Events:r,KeyHandler:i,Log:s,Url:o,log:s.write,module:c,ready:h,start:p,stop:d}}(window,document);